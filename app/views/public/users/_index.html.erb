<table class="table table-striped border-bottom">
  <% users.each do |user| %>

    <tr>
      <td class="py-1">

        <div class="d-flex align-items-center">

          <div>
            <%= image_tag user.get_image, class: "rounded-circle", size: "50x50" %>
          </div>

          <div>
            <%= link_to user_path(user) do %>
              <span class="ml-3"><%= user.name %></span>
            <% end %>
          </div>

          <div class="ml-auto">
            <% if current_user %>
              <% unless user.guest_user? || current_user.guest_user? %>
                <% if current_user == user %>
                <!--自分にはフォロー/フォロー解除ボタンが表示されない-->
                <% else %>
                  <% if current_user.following?(user) %>
                    <%= link_to "フォロー解除", user_relationships_path(user.id), method: :delete, class: "btn btn-sm btn-outline-secondary" %>
                  <% else %>
                    <%= link_to "フォローする", user_relationships_path(user.id), method: :post, class: "btn btn-sm btn-outline-secondary" %>
                  <% end %>
                <% end %>
            <% else %>
              <!--ログインしていない時は空白-->
              <% end %>
            <% end %>
          </div>

        </div>

      </td>
    </tr>

    <% end %>
</table>